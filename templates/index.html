{% extends "base.html" %}

{% block title %}Home{% endblock %}

{% block content %}
<div class="text-center mt-5">
  <h1 class="display-4">Welcome to OleeFit Exercise Assistant</h1>
  <p class="lead mt-3">
    Ask exercise-related questions like:
    <em>“What are good beginner ab workouts?”</em> or
    <em>“Suggest back exercises using dumbbells.”</em>
  </p>

  <form id="queryForm" class="d-flex justify-content-center mt-4">
    <input type="text" id="queryInput" class="form-control w-50 me-2"
           placeholder="Ask about exercises, muscle groups, equipment..." required>
    <button type="submit" class="btn btn-success">Get Recommendation</button>
  </form>

  <div id="loading" class="mt-3 text-muted" style="display: none;">Processing...</div>

  <div id="responseBox" class="mt-5 p-4 bg-light border rounded text-start" style="display: none;">
    <h5>AI Recommendation:</h5>
    <p id="responseText"></p>
  </div>
</div>

<script>
document.getElementById("queryForm").addEventListener("submit", function(event) {
    event.preventDefault();

    const query = document.getElementById("queryInput").value;
    const loading = document.getElementById("loading");
    const responseBox = document.getElementById("responseBox");
    const responseText = document.getElementById("responseText");

    loading.style.display = "block";
    responseBox.style.display = "none";

    fetch("/ask", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify({ query: query })
    })
    .then(response => response.json())
    .then(data => {
        loading.style.display = "none";
        responseText.textContent = data.response;
        responseBox.style.display = "block";
    })
    .catch(error => {
        loading.textContent = "An error occurred.";
        console.error("Error:", error);
    });
});
</script>
{% endblock %}
